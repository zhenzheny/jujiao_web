<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0,viewport-fit=cover ">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta content="telephone=no" name="format-detection">
    <meta name="wap-font-scale" content="no">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>教师详情</title>
    <link href="../css/index.css?+Math.random()" rel="stylesheet">
    <link href="../css/scrollbar.css" rel="stylesheet">
    
    <body class="marginNone padBottom20 theBody">
      <div class="teaHeader">
      	<div id="bgImg" class="laoBg"></div>
       	<div class="out_filter fliter_img"></div>
       	<div class="teaTou"> 
       		<img id="teaImg" class="teaIcon"/>
       		<span class="teaName" id="teaName"></span>
       	</div>
       	<ul class="teaJie">
       		<li><img src="../images/laoLing.png/">
       		<span id="jiaoLing"></span>
       		</li>
       		<li><img src="../images/laoTea.png">
       		<span id="position"></span>
       		</li>
       	</ul>
       </div>
      <div class="mainContent actBlo ">
      
       <ul class="keShiUl teaJianJie marBottom12 borBottom10" id="feeMode">
       </ul>
       <p class="title color2C size13 padTop20 marBottom10 teaJianJie">老师简介</p>
            <p class="tea_line size12 borTop color999 hasBig posRelite teaJieShao teaJianJie">上课地区：<span class="width50P" id="adress"></span></p>
            <div class="webkBlo tea_line marTop4 teaJieShao teaJianJie">
            	<span class="size12 color999">老师标签：</span>
            	<p id="biaoQian" class="webInp" style="color:#656565;"></p>
            </div>
       		<div class="greyMargin8"></div>
             <p class="color8d size13 padTop20 marBottom7 teaJianJie">老师认证</p>
             <p class="teaCard teaJianJie borTop borBottom10" id="teaCard">
             	
             </p>
        <p class="color8d size13 showtitle teaJianJie">自我介绍</p>
        <div class="teaJianJie">
        	<p class="size12 color999 selfCon" id="descript"></p>
        </div>
      </div>
       <ul class="tabUl padLeftRight borTop borBottom">
      <li class="active" style="width: 50%;">
        <span>课程</span></li>
      <li style="width: 50%;">
        <span>相册</span></li>
    </ul>
    <div class="tabBlock">
      <div class="tabContent borBottom">
        <div class="tabCon padLeftRight">
          <div id="MuluId" class="marTop10">
          	<!--目录-->
          </div>
          <p class="seeMore">查看更多课程</p>
        </div>
        <div class="tabCon disNone">
          <div class="padLeftRight padBottom20">
          	<ul class="xiangUl" id="album">
          		<li>
          			<img src="../images/laoCe.png" />
          		</li>
          		<li>
          			<img src="../images/laoCe.png" />
          		</li>
          		<li>
          			<img src="../images/laoCe.png" />
          		</li>
          		<li>
          			<img src="../images/laoCe.png" />
          		</li>
          		<li>
          			<img src="../images/laoCe.png" />
          		</li>
          		<li>
          			<img src="../images/laoCe.png" />
          		</li>
          	</ul>
        </div>
        </div>
      </div>
    </div>
    <div class="liaoAnBlo"></div>
    <script src="../js/zepto.min.js"></script>
    <script src="../js/iscroll.js"></script>
		<script src="../js/iscroll4.2.5.js"></script>
		<script src="../js/startScore.js"></script>
		<script src="../js/common.js"></script>
      <script>!(function($) {
        var g = {
          init: function() {
            var _t = this;
            //调用tab
            _t.tab();
            /*老师详情*/
           _t.teaDetail();
	         /*加载图片*/
	        _t.default();
	        /*课程提纲*/
	       _t.syllabus();
          },
          //调用tab
          tab: function() {
            var _t = this;
            $(".tabUl li").each(function(index, element) {
              var i = index;
              $(this).on('click',
              function() {
                $(".tabUl li").removeClass("active");
                $(this).addClass("active");
                $(".tabContent .tabCon").hide();
                $(".tabContent .tabCon").eq(i).show();

              });
            });
          },
          /*老师详情*/
         teaDetail:function(){
         	var _t=this;
        	 //通过链接获取id
            var url=location.search; 
						if(url.indexOf("?")!=-1) 
						{
							function GetQueryString(name)
							{
							     var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
							     var r = window.location.search.substr(1).match(reg);
							     if(r!=null)return  unescape(r[2]); return null;
							}
							GetQueryString("id");
							var idNum=GetQueryString("id");
							var userId=GetQueryString("user_id");
							var relaId=idNum;
							var uId=userId;
							var parm={"id":idNum,"user_id":userId};
							}
							else{
								var parm={"id":1,"user_id":1};
								var relaId=1;
								var uId=1;
							}
                $.ajax({
                    type: 'POST',
                    url: jieUrl+'271',
                    data: parm,
                    headers:{ut:tokenData},
                    dataType: 'json',
                    success: function(data) {
//                  	window.location.reload() 
                    	if(hasPlus>-1){
                    		
                    	}else{
                    		$(".teaHeader,.mainContent,.xiangUl,.tabBlock,.seeMore,.video-block").on('click',function(){
                    			downLoad();
                    		});
                    		function downLoad(){
	                           		var u = navigator.userAgent, app = navigator.appVersion;
																	var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Linux') > -1; //android终端或者uc浏览器
																	var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
																	
																	if(isAndroid==1){
																		//此处是安卓的留白
																	window.location.href=andAppUrl;
																	}else if(isiOS==1){
																	window.location.href=iosAppUrl;
																	}
									       }
                    	}
                    	//alert("测试id="+idNum+"测试user_id="+userId)
                    	var data=data.d;
                    	$("#teaName").html(data.nickname);
                    	$("#jiaoLing").html(data.teach_age+"年教龄");
                    	$("#position").html((data.subject_name==null?"暂无":data.subject_name));
                    	if((data.img_url).indexOf("http")<0){
                    		$("#teaImg").attr("src",imgUrl+data.img_url);
                    		$("#bgImg").css("background-image","url('"+imgUrl+data.img_url+"')");
//                  		$("#bgImg").attr("src",);
                    	}else{
                    		$("#teaImg").attr("src",data.img_url);
                    		$("#bgImg").css("background-image","url('"+data.img_url+"')");
                    	}
                    	$("#adress").html(data.location==null?"该老师很懒，什么也没留下":data.location);
                    	if(data.specialty==null){
                    	}else{
		                    	var spanCon=data.specialty;
		                    	var spanlist=spanCon.split("，");
		                    	var spanHtml="";
		                    	for(i=0;i<spanlist.length;i++){
		                    		spanHtml+="<span class='greyborSpan marRight2'>"+spanlist[i]+"</span>";
		                    	}
                    	};
                    	$("#descript").html((data.introduce==null?"这位老师好懒，什么都没留下~~":data.introduce));
                    	if(data.album_url==null){
                    		$("#album").html("<p class='greyFont padLeftRight marTop10'>暂无相册</p>");
                    	}else{
                    		var album=(data.album_url).split(",");
	                    	var albumCon="";
	                    	for(i=0;i<album.length;i++){
	                    		if(album[i].indexOf("http")<0){
	                    		albumCon+="<li style='background-image:url("+imgUrl+album[i]+")'></li>";
	                    		}else{
	                    			albumCon+="<li style='background-image:url("+album[i]+")'></li>";
	                    		}
	                    	}
	                    	$("#album").html(albumCon);
                    	}
                    	if(data.mode.length>0){
                    		$("#feeMode").show()
                    		var feeMode="";
	                    	for(i=0;i<data.mode.length;i++){
	                    		feeMode+="<li>"+data.mode[i].fee_price+"元/"+(data.mode[i].fee_unit==1?"小时":"天")+"<span class='greyFont greyborSpan marLeft9'>"+(data.mode[i].teach_mode==1?"一对一":"一对多")+"</span></li>";
	                    	}
	                    	$("#feeMode").html(feeMode);
                    	}else{
                    		$("#feeMode").hide();
                    	}
                    	/*老师标签*/
                    	var tagsCon="";
                    	if(data.tags<1){
                    		$("#biaoQian").html("这位老师暂时没有标签哟");
                    	}else{
                    		for(i=0;i<data.tags.length;i++){
                    			tagsCon+="<span class='tagsSpan'>"+data.tags[i].title+"</span>";
                    		}
                    		$("#biaoQian").html(tagsCon);
                    	}
                    	/*老师认证*/
                    	var cardCon="";
                    	var sheMarry=new Array();
                    	sheMarry=["身份","教师证","学历","专业资质","工作单位"];
                    	var certifications=data.teacherCertifications;
                    	if(certifications){
                    		//$("#teaCard").html("暂无认证标识哟");
							for(i=0;i<certifications.length;i++){
								if(certifications[i].ide_type==1||certifications[i].ide_type==6){
									cardCon+="<span><img src='../images/cardCheck.png' />"+sheMarry[0]+"认证</span>"
								}
								if(certifications[i].ide_type==2){
									cardCon+="<span><img src='../images/cardCheck.png' />"+sheMarry[1]+"认证</span>"
								}
								if(certifications[i].ide_type==3){
									cardCon+="<span><img src='../images/cardCheck.png' />"+sheMarry[2]+"认证</span>"
								}
								if(certifications[i].ide_type==4){
									cardCon+="<span><img src='../images/cardCheck.png' />"+sheMarry[3]+"认证</span>"
								}
								if(certifications[i].ide_type==5){
									cardCon+="<span><img src='../images/cardCheck.png' />"+sheMarry[4]+"认证</span>"
								}
	                    	}
                    	    $("#teaCard").html(cardCon);
                    	}else{
                    		$("#teaCard").html("暂无认证标识哟");
                    	}
                    	_t.default();
                    }
                 });
         },
					/*图片加载*/
					default:function(){
						var_t=this;
						$('img').error(function(){
							$(this).attr("src","../images/default.png");
						});
					},
					/*课程提纲*/
					syllabus:function(){
						var _t=this;
							var url=location.search; 
						if(url.indexOf("?")!=-1) 
						{
							function GetQueryString(name)
							{
							     var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
							     var r = window.location.search.substr(1).match(reg);
							     if(r!=null)return  unescape(r[2]); return null;
							}
							GetQueryString("id");
							var idNum=GetQueryString("id");
							var userId=GetQueryString("user_id");
							var relaId=idNum;
							var uId=userId;
							var parm={"id":userId,"teacher_id":idNum,"page":1,"page_size":4};
							}
							else{
								var parm={"id":1,"teacher_id":1,"page":1,"page_size":4};
								var relaId=1;
								var uId=1;
							}
						$.ajax({
			              type: 'POST',
			              url: jieUrl+'100470',
			              data:parm,
			              headers:{ut:tokenData},
			              dataType: 'json',
			              success: function(data) {
			              	var data=data.d;
			              	if(data.length>0){
			              		var con="<div class='video-block'>";
			              		for(i=0;i<data.length;i++){
			              			if(data[i].imgurl==null){
			              				data[i].imgurl="../images/default.png";
			              			}else{
			              				if(data[i].imgurl.indexOf("http")<0){
					              			data[i].imgurl=imgUrl+data[i].imgurl;
					              		}
			              			}
			              		 con+="<div class='course-wrapper'><div class='conten-out' data-id='"+data[i].id+"' data-kill='"+data[i].is_kill+"' data-id='"+data[i].id+"' data-course='"+data[i].course_type+"' data-type='"+data[i].type+"'><img class='index-img' src='../images/onVideo.png' /><img class='starVideo' src='../images/onVideoStart.png'/><img src='"+data[i].imgurl+"' /></div><p class='tea-course-tit'><span class='blue-video'>视频课</span>"+data[i].title+"</p></div>";
			              		}
			              		if(data.length==4){
			              		con+="</div>";
			              		$(".seeMore").show();
			              		}else  if(data.length<4){
			              			con+="</div>";
			              		}
			              		$("#MuluId").html(con);
			              		_t.default();
			              	}else{
			              		$("#MuluId").html("<p class='greyFont marBottom10 padBottom10'>暂无课程记录</p>");
			              		$(".seeMore").hide();
			              	}
			              	var page=1;
			              	$(".seeMore").on('click',function(){
			              		page++;
			              		_t.loadMore(page,idNum,userId);
			              	});
			              	/*点击跳转视频页面*/
			              	$(".course-wrapper>.conten-out").each(function(index,element){
			              		$(this).on('click',function(){
			              			var videoType=$(this).attr("data-course");
			              			var lineType=$(this).attr("data-type");
			              			var kill=$(this).attr("data-kill");
			              			var dataId=$(this).attr("data-id");
			              			/*全课程*/
			              			if(videoType==1){
			              				/*秒杀课*/
			              				if(kill==1){
//			              						if(lineType==1){
//					              					/*视频课*/
//					              					console.log("第咦种啊第二种")
//						              					window.location.href=pageUrl+'msg/207m.html?id='+relaId+"&"+"user_id="+uId;
//						              				}else{
//						              					console.log("第二种啊第二种")
//						              					window.location.href=pageUrl+'msg/207m-2.html?id='+relaId+"&"+"user_id="+uId;
//						              				}
			              				}else if(kill==0){
//			              						if(lineType==1){
//					              					/*视频课*/
//					              					window.location.href=pageUrl+'msg/207.html?id='+relaId+"&"+"user_id="+uId;
//					              				}else{
//					              					window.location.href=pageUrl+'msg/207-2.html?id='+relaId+"&"+"user_id="+uId;
//					              				}
			              				}
			              			}else if(videoType==2){
			              				/*直播课*/
			              				//window.location.href=pageUrl+'msg/222.html?id='+relaId+"&"+"user_id="+uId;
			              			}
			              			else if(videoType==3){
			              				//alert(pageUrl+'msg/232.html?id='+relaId+"&"+"user_id="+uId)
			              				/*分期返*/
//			              				if(lineType==1){
//			              					/*视频课*/
//			              				window.location.href=pageUrl+'msg/232.html?id='+relaId+"&"+"user_id="+uId;
//			              				}else{
//			              				window.location.href=pageUrl+'msg/232-2.html?id='+relaId+"&"+"user_id="+uId;
//			              				}
			              			}else if(videoType==4){
			              				/*一元课*/
//			              				if(lineType==1){
//			              				window.location.href=pageUrl+'msg/241.html?id='+relaId+"&"+"user_id="+uId;
//			              				}else{
//			              				window.location.href=pageUrl+'msg/241-2.html?id='+relaId+"&"+"user_id="+uId;
//			              				}
			              			}
		                       	if(isAndroid==1){
																//此处是安卓的留白
																//{dataId,videoType,kill,lineType}
																window.android.classType(dataId,videoType,kill,lineType);
															}else if(isiOS==1){
									        			window.webkit.messageHandlers.classType.postMessage({id:dataId,type:videoType,iskill:kill,line:lineType});
															}
			              		});
			              	});
			              	_t.default();
			              	
			              },
			              error: function(xhr, type) {
			                console.info("服务器出错");
			              }
			            })
					},
					 /*查看更多*/
             loadMore:function(page,idNum,userId){
             	var _t=this;
             	var parm={"id":userId,"teacher_id":idNum,"page":page,"page_size":4};
             	console.log(parm)
             		$.ajax({
			              type: 'POST',
			              url: jieUrl+'100470',
			              data:parm,
			              headers:{ut:tokenData},
			              dataType: 'json',
			              success: function(data) {
			              	var data=data.d;
			              		var con="<div class='video-block'>";
			              		for(i=0;i<data.length;i++){
			              				if(data[i].imgurl.indexOf("http")<0){
					              			data[i].imgurl=imgUrl+data[i].imgurl;
					              		}
			              		 con+="<div class='course-wrapper'><div class='conten-out'><img class='index-img' src='../images/onVideo.png' /><img class='starVideo' src='../images/onVideoStart.png'/><img src='"+data[i].imgurl+"' data-id='"+data[i].id+"' data-course='"+data[i].course_type+"' data-type='"+data[i].type+"'/></div><p class='tea-course-tit'>"+data[i].title+"</p></div>";
			              		}
			              		if(data.length==4){
			              		con+="</div>";
			              		}else  if(data.length<4){
			              			con+="</div><p class='seeMore'>没有更多课程了</p>";
			              			$(".seeMore").hide();
			              		}
			              		$("#MuluId").append(con);
			              		$(".conten-out").each(function(index,element){
			              		$(this).on('click',function(){
			              			var videoType=$(this).attr("data-course");
			              			var lineType=$(this).attr("data-type");
			              			var kill=$(this).attr("data-kill");
			              			var dataId=$(this).attr("data-id");
			              			/*全课程*/
			              			if(videoType==1){
			              				/*秒杀课*/
			              				if(kill==1){
//			              						if(lineType==1){
//					              					/*视频课*/
//						              					window.location.href=pageUrl+'msg/207m.html?id='+relaId+"&"+"user_id="+uId;
//						              				}else{
//						              					window.location.href=pageUrl+'msg/207m-2.html?id='+relaId+"&"+"user_id="+uId;
//						              				}
			              				}else if(kill==0){
//			              						if(lineType==1){
//					              					/*视频课*/
//					              					window.location.href=pageUrl+'msg/207.html?id='+relaId+"&"+"user_id="+uId;
//					              				}else{
//					              					window.location.href=pageUrl+'msg/207-2.html?id='+relaId+"&"+"user_id="+uId;
//					              				}
			              				}
			              			}else if(videoType==2){
			              				/*直播课*/
			              				//window.location.href=pageUrl+'msg/222.html?id='+relaId+"&"+"user_id="+uId;
			              			}
			              			else if(videoType==3){
			              				/*分期返*/
//			              				if(lineType==1){
//			              					/*视频课*/
//			              				window.location.href=pageUrl+'msg/232.html?id='+relaId+"&"+"user_id="+uId;
//			              				}else{
//			              				window.location.href=pageUrl+'msg/232-2.html?id='+relaId+"&"+"user_id="+uId;
//			              				}
			              			}else if(videoType==4){
			              				/*一元课*/
//			              				if(lineType==1){
//			              				window.location.href=pageUrl+'msg/241.html?id='+relaId+"&"+"user_id="+uId;
//			              				}else{
//			              				window.location.href=pageUrl+'msg/241-2.html?id='+relaId+"&"+"user_id="+uId;
//			              				}

			              			}
		                       	if(isAndroid==1){
																//此处是安卓的留白
																//{dataId,videoType,kill,lineType}
																window.android.classType(dataId,videoType,kill,lineType);
															}else if(isiOS==1){
									        			window.webkit.messageHandlers.classType.postMessage({id:dataId,type:videoType,iskill:kill,line:lineType});
															}
			              		});
			              	});
			              		_t.default();
			              }
			              });
             }
        }
        $(function() {
          g.init();
        });
      })($);</script>
       
    </body>

</html>